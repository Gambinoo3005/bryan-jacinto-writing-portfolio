---
import { getCollection } from "astro:content";
import CaseStudyLayout from "../../layouts/CaseStudyLayout.astro";
import BlogLayout from "../../layouts/BlogLayout.astro";

export async function getStaticPaths() {
  const entries = await getCollection("work", ({ data }) => !data.draft);
  return entries.map((entry) => ({
    params: { slug: entry.slug },
    props: { entry },
  }));
}

const { entry } = Astro.props;
const { Content } = await entry.render();

const tags = entry.data.tags ?? [];
const badgeLabel = tags.includes("Article")
  ? "Article"
  : tags.includes("Website")
    ? "Website"
    : "Case Study";
const isArticle = badgeLabel === "Article";
---

{isArticle ? (
  <BlogLayout
    title={entry.data.title}
    description={entry.data.summary}
    pubDate={entry.data.pubDate}
    tags={entry.data.tags}
    ogImage={entry.data.ogImage}
    heroImage={entry.data.heroImage || entry.data.hero}
    badgeLabel="Article"
    roleLabel={entry.data.client ?? "Bryan Jacinto"}
    backHref="/work"
    backText="Back to Work"
  >
    <Content />
  </BlogLayout>
) : (
  <CaseStudyLayout
    title={entry.data.title}
    description={entry.data.summary}
    pubDate={entry.data.pubDate}
    tags={entry.data.tags}
    ogImage={entry.data.ogImage}
    heroImage={entry.data.heroImage || entry.data.hero}
    client={entry.data.client}
    industry={entry.data.industry}
    results={entry.data.results}
  >
    <Content />
  </CaseStudyLayout>
)}
