---
import BaseLayout from "../../layouts/BaseLayout.astro";
import SimpleWritingShowcase from "../../components/SimpleWritingShowcase.astro";
import { getCollection } from "astro:content";

const workItems = (await getCollection("work", ({ data }) => !data.draft))
  .sort((a, b) => +b.data.pubDate - +a.data.pubDate);

const posts = (await getCollection("posts", ({ data }) => !data.draft))
  .sort((a, b) => +b.data.pubDate - +a.data.pubDate);

// Combine work items and posts into writing samples
const writingSamples = [
  ...workItems.map((item) => ({
    id: `work-${item.slug}`,
    title: item.data.title,
    type: 'case-study' as const,
    category: 'Case Study',
    client: item.data.client || 'Aptean',
    excerpt: item.data.summary || 'A comprehensive case study documenting successful ERP implementation and business transformation.',
    tags: item.data.tags || [],
    readTime: '5 min read',
    publishedDate: item.data.pubDate.toISOString(),
    link: `/work/${item.slug}`,
    featured: (item.data as any).featured || false,
    wip: false
  })),
  ...posts.map((post) => ({
    id: `post-${post.slug}`,
    title: post.data.title,
    type: 'article' as const,
    category: 'Thought Leadership',
    excerpt: post.data.description || 'An insightful article on content strategy, SEO, and writing best practices.',
    tags: (post.data as any).tags || ['writing', 'content strategy'],
    readTime: '3 min read',
    publishedDate: post.data.pubDate.toISOString(),
    link: `/articles/${post.slug}`,
    featured: false,
    wip: false
  })),
  // Website projects
  {
    id: 'website-1',
    title: 'Uragon Transport Services',
    type: 'copy' as const,
    category: 'Website Development',
    client: 'Uragon Transport Services',
    excerpt: 'Complete full-stack web development project including frontend design, backend development, SEO optimization, and copywriting for a car rental service in Bicol Region, Philippines.',
    tags: ['Next.js', 'Tailwind CSS', 'full-stack development', 'SEO', 'copywriting'],
    readTime: '5 min read',
    publishedDate: new Date('2025').toISOString(),
    link: 'https://uragon-transport-services.vercel.app/',
    featured: true,
    wip: false
  },
  {
    id: 'website-2',
    title: 'Go Leap Digital | Take the Leap. Go Digital.',
    type: 'copy' as const,
    category: 'Website Development',
    client: 'Go Leap Digital',
    excerpt: 'Full-stack development for a digital marketing agency specializing in modern web solutions. Comprehensive project including Next.js frontend architecture, responsive design system, SEO optimization, and strategic copywriting to drive client conversions.',
    tags: ['Next.js', 'Tailwind CSS', 'full-stack development', 'SEO', 'copywriting'],
    readTime: '6 min read',
    publishedDate: new Date('2025').toISOString(),
    link: 'https://go-leap-digital.vercel.app/',
    featured: false,
    wip: true
  }
].sort((a, b) => {
  // Featured items first
  if (a.featured && !b.featured) return -1;
  if (!a.featured && b.featured) return 1;
  
  // Then sort by date (newest first)
  return new Date(b.publishedDate).getTime() - new Date(a.publishedDate).getTime();
});
---
<BaseLayout title="Work - Case Studies" description="Selected client projects and outcomes.">
  <section class="w-full" style="background-color: var(--section-bg-primary);">
    <div class="mx-auto max-w-6xl px-5 sm:px-6 py-16 scroll-reveal">
      <div class="text-center" style="margin-bottom: 50px;">
        <h1 class="mb-4">My Writing Portfolio</h1>
        <p class="text-lg text-[var(--color-muted)] max-w-2xl mx-auto">
          Explore my case studies, articles, and writing samples.
        </p>
      </div>
      
      <SimpleWritingShowcase writingSamples={writingSamples} />
    </div>
  </section>
</BaseLayout>

